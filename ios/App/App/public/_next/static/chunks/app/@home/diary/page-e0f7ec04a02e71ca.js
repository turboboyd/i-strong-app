(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4787],{4190:function(e,r,n){Promise.resolve().then(n.bind(n,5208))},2968:function(e,r,n){"use strict";n.d(r,{B3:function(){return y},OW:function(){return _},Vc:function(){return l},Xo:function(){return s},_K:function(){return b},os:function(){return c},s6:function(){return m}});var a=n(4642),t=n(568),o=n(2265),d=n(5520),i=n(9619);let c=(e,r)=>(0,d.Q)("users/diary/main/",{method:"POST",body:e,headers:{Authorization:"Bearer ".concat(r)}}),s=(e,r,n)=>(0,d.Q)("users/diary/main/".concat(n,"/"),{method:"PUT",body:e,headers:{Authorization:"Bearer ".concat(r)}}),_=(e,r)=>(0,d.Q)("users/diary/main/".concat(e,"/"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r)}}),l=e=>(0,a.a)({queryKey:["getDiaryRecords"],queryFn:()=>u(e)}),u=async e=>(0,d.Q)("users/diary/main/",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}),y=(e,r)=>(0,a.a)({queryKey:["getSingleDiaryRecord"],queryFn:()=>h(e,r),enabled:!1}),h=async(e,r)=>(0,d.Q)("users/diary/main/".concat(r),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}),m=(e,r,n)=>(0,a.a)({queryKey:["getRecordsByDate"],queryFn:()=>v(e,r,n),enabled:!1}),v=async(e,r,n)=>(0,d.Q)("users/diary/main/by-date/".concat(r,"/").concat(n),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}),x=async(e,r)=>(0,d.Q)("users/diary/check-password/",{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:r}),b=()=>{let{user:e}=(0,i.LM)(),r=(0,i.LM)(e=>{var r;return null==e?void 0:null===(r=e.user)||void 0===r?void 0:r.has_dairy_password}),[n,a]=(0,o.useState)(!1),d=(null==e?void 0:e.access_token)||"",{mutate:c,status:s}=(0,t.D)({mutationFn:e=>x(d,e),onSuccess:e=>{a(e)},onError:e=>{console.log("Error: ".concat(e.message))}});return{mutateCheckPinCode:c,status:s,passShow:r&&!n,isPinVerified:n,setIsPinVerified:a}}},60:function(e,r,n){"use strict";n.d(r,{$3:function(){return o},J7:function(){return s},Yx:function(){return i},pg:function(){return l}});var a=n(4642),t=n(5520);let o=e=>(0,a.a)({queryKey:["getNotes"],queryFn:()=>d(e)}),d=async e=>(0,t.Q)("users/diary/notes/",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}),i=(e,r)=>(0,a.a)({queryKey:["getAllNotesByChallenge"],queryFn:()=>c(e,r),enabled:!1}),c=async(e,r)=>(0,t.Q)("users/diary/notes/by-challenge/".concat(r),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}),s=(e,r)=>(0,a.a)({queryKey:["getSingleNoteRecord"],queryFn:()=>_(e,r),enabled:!1}),_=async(e,r)=>(0,t.Q)("users/diary/notes/".concat(r),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}),l=(e,r,n)=>(0,t.Q)("users/diary/notes/".concat(n,"/"),{method:"PUT",body:e,headers:{Authorization:"Bearer ".concat(r)}})},5208:function(e,r,n){"use strict";n.r(r),n.d(r,{DiaryComponent:function(){return B},default:function(){return D}});var a=n(7437),t=n(7907),o=n(568),d=n(2151),i=n.n(d),c=n(2968),s=n(7386),_=n(130),l=n(9619),u=n(8789),y=n.n(u),h=e=>{let{item:r,diaryRecordsRefetch:n,type:d}=e,u=(0,t.useRouter)(),h=(0,l.LM)(e=>{var r;return null===(r=e.user)||void 0===r?void 0:r.access_token}),{mutate:m}=(0,o.D)({mutationFn:e=>(0,c.OW)(e,null!=h?h:""),onSuccess:e=>{n&&n()}});return(0,a.jsxs)("article",{className:y().diary_card,onClick:()=>{"note"===d?u.push("/diary/note-record?record_id=".concat(r.id.toString())):u.push("/diary/record?record_id=".concat(r.id.toString()))},children:[(0,a.jsxs)("div",{className:y().diary_card__header,children:[(0,a.jsx)("span",{children:i()(null==r?void 0:r.created_at).format("DD.MM.YYYY")}),"note"!==d&&(0,a.jsx)(s.r,{onClick:()=>{m(r.id.toString())},name:"delete record",children:(0,a.jsx)(_.kJ,{})})]}),(0,a.jsxs)("div",{className:y().diary_card__main,children:[(0,a.jsx)("p",{className:y().diary_card__title,children:null==r?void 0:r.title}),(0,a.jsx)("p",{className:y().diary_card__text,children:null==r?void 0:r.note})]})]})},m=n(2670),v=n(6583),x=n(3190),b=n(7853),j=n.n(b),f=e=>{let{onVerify:r}=e,{handleSubmit:n,control:t,formState:{isValid:o}}=(0,m.cI)({mode:"onTouched",reValidateMode:"onChange"});return(0,a.jsxs)("section",{className:"".concat(j().diary," container"),children:[(0,a.jsx)(v.qA,{title:"Введи пароль"}),(0,a.jsx)(v.cD,{onSubmit:n(e=>{r(e)}),textButton:"Далі",isFormValid:o,children:(0,a.jsx)(m.Qr,{control:t,name:"dairy_password",render:e=>{let{field:{value:r,onChange:n}}=e;return(0,a.jsx)(v.kq,{length:4,value:r,onChange:e=>n(e)})},rules:{required:x.C1,minLength:{value:4,message:""}}})})]})};n(1309);var p=n(2265),g=n(60),N=n(8186),k=n.n(N),C=()=>{var e;let r=(0,l.LM)(e=>{var r;return null===(r=e.user)||void 0===r?void 0:r.access_token}),[n,t]=(0,p.useState)(null),{data:o,refetch:d}=(0,g.$3)(null!=r?r:""),{data:i,refetch:c,isFetching:u}=(0,g.Yx)(null!=r?r:"",null!=n?n:""),y=e=>{e.toString()===n?t(null):(t(e.toString()),setTimeout(()=>c(),0))};return(0,a.jsx)("div",{className:k().notes,children:null==o?void 0:null===(e=o.notes)||void 0===e?void 0:e.map((e,r)=>(0,a.jsxs)("div",{className:k().notes__record_block,children:[(0,a.jsx)("p",{children:e.challenge.title}),(0,a.jsxs)("div",{className:k().notes__cards,children:[(0,a.jsx)("div",{className:k().diary__visible_cards,children:e.notes.slice(0,2).map(e=>(0,a.jsx)(h,{item:e,type:"note"},"".concat(e.id,"-").concat(r)))}),!u&&i&&(0,a.jsx)("div",{className:"".concat(k().notes__hidden_cards," ").concat(n===e.challenge.id.toString()&&k().extended),children:(0,a.jsx)("div",{className:k().notes__hidden_wrapper,children:null==i?void 0:i.notes.slice(2).map((e,r)=>(0,a.jsx)(h,{item:e,type:"note"},"".concat(r,"--").concat(e.id)))})}),e.notes.length>2&&(0,a.jsx)("div",{className:"".concat(k().notes__arrow_btn," ").concat(n===e.challenge.id.toString()&&k().extended),children:(0,a.jsx)(s.r,{onClick:()=>y(e.challenge.id),name:"open all",children:(0,a.jsx)(_.Ej,{})})})]})]},"".concat(e.challenge.id,"-").concat(r)))})},S=n(4796),w=n(5029),A=n.n(w);let B=()=>{var e,r,n,o,d;let u=(0,t.useRouter)(),y=(0,l.LM)(e=>{var r;return null===(r=e.user)||void 0===r?void 0:r.access_token}),[m,x]=(0,p.useState)("main"),[b,j]=(0,p.useState)({year:null,month:null}),{data:g,refetch:N}=(0,c.Vc)(null!=y?y:""),{data:k,refetch:w,isFetching:B}=(0,c.s6)(null!=y?y:"",null!==(o=null===(e=b.year)||void 0===e?void 0:e.toString())&&void 0!==o?o:"",null!==(d=null===(r=b.month)||void 0===r?void 0:r.toString())&&void 0!==d?d:""),D=(e,r)=>{b.year===e&&b.month===r?j({year:null,month:null}):(j({year:e,month:r}),setTimeout(()=>w(),0))},E=()=>{N()},{mutateCheckPinCode:M,passShow:R}=(0,c._K)();return R?(0,a.jsx)(f,{onVerify:e=>{M(e)}}):(0,a.jsxs)("section",{className:"".concat(A().diary," container"),children:[(0,a.jsx)("h1",{className:"title",children:"Щоденник"}),(0,a.jsx)(v.N3,{buttons:[{id:"main",text:"Основні",isActive:"main"===m},{id:"notes",text:"Нотатки",isActive:"notes"===m}],onButtonClick:x}),"main"==m&&(0,a.jsx)(a.Fragment,{children:(null==g?void 0:g.has_note_today)?(0,a.jsx)("p",{className:A().diary__disable_new_record,children:"Запис про сьогоднішній день вже створено. Так тримати!"}):(0,a.jsx)(v.r0,{variant:"outlined",onClick:()=>{u.push("/diary/record")},children:"Додати запис"})}),"main"===m?(0,a.jsx)("div",{className:A().diary__records,children:null==g?void 0:null===(n=g.notes)||void 0===n?void 0:n.map((e,r)=>{var n;return(0,a.jsx)("div",{className:A().diary__records,children:null==e?void 0:null===(n=e.months)||void 0===n?void 0:n.map((r,n)=>(0,a.jsxs)("div",{className:A().diary__record_block,children:[(0,a.jsxs)("p",{children:[i()().month(r.month).format("MMMM")," ",e.year]}),(0,a.jsxs)("div",{className:A().diary__record_cards,children:[(0,a.jsx)("div",{className:A().diary__visible_cards,children:r.notes.slice(0,3).map(e=>(0,a.jsx)(h,{item:e,diaryRecordsRefetch:E},"".concat(e.id,"-").concat(n)))}),!B&&(null==k?void 0:k.notes)&&(0,a.jsx)("div",{className:"".concat(A().diary__hidden_cards," ").concat(b.month===r.month&&b.year===e.year&&A().extended),children:(0,a.jsx)("div",{className:A().diary__hidden_wrapper,children:null==k?void 0:k.notes.slice(3).map((e,r)=>(0,a.jsx)(h,{item:e,diaryRecordsRefetch:E},"".concat(e.id,"-").concat(r)))})}),r.notes.length>3&&(0,a.jsx)("div",{className:"".concat(A().diary__arrow_btn," ").concat(b.month===r.month&&b.year===e.year&&A().extended),children:(0,a.jsx)(s.r,{onClick:()=>D(e.year,r.month),name:"open all",children:(0,a.jsx)(_.Ej,{})})})]})]},"".concat(r.month,"-").concat(n)))},"".concat(e.year,"-").concat(r))})}):(0,a.jsx)(C,{}),(0,a.jsx)(v.Hu,{title:"Щоденник - це надійне місце для усіх твоїх спогадів та емоцій. Роби записи кожного дня щоб отримувати",coin:!0,image:S.Nf,buttonText:"Круто!",check:"diary"})]})};var D=B},1309:function(e,r,n){"use strict";n.r(r),n.d(r,{DiaryRecordComponent:function(){return C}});var a=n(7437),t=n(7907),o=n(568),d=n(7473),i=n(9540),c=n(2759),s=n(2357),_=n(7181),l=n(4586),u=n(2151),y=n.n(u),h=n(2265),m=n(2670),v=n(2968),x=n(6583),b=n(6633),j=n(7386),f=n(130),p=n(9619),g=n(3190),N=n(9091),k=n.n(N);let C=()=>{var e,r;let n=(0,p.LM)(e=>{var r;return null===(r=e.user)||void 0===r?void 0:r.access_token}),{control:u,watch:N}=(0,m.cI)(),C=(0,t.useSearchParams)(),S=(0,t.useRouter)(),{data:w,refetch:A,status:B}=(0,v.B3)(null!=n?n:"",null!==(e=C.get("record_id"))&&void 0!==e?e:""),D=(0,_.jE)({content:"",extensions:[c.V.configure({placeholder:"Як ти?"}),d.I.configure({types:[s.Z.name,i.Z.name]}),s.Z.configure(),l.Z.configure({bulletList:{keepMarks:!0,keepAttributes:!1},orderedList:{keepMarks:!0,keepAttributes:!1}})],editable:!0});(0,h.useEffect)(()=>{A()},[C.get("record_id")]),(0,h.useEffect)(()=>{var e;null==D||D.commands.setContent(null!==(e=null==w?void 0:w.note)&&void 0!==e?e:"")},[w,D]);let{mutate:E}=(0,o.D)({mutationFn:e=>(0,v.os)(e,null!=n?n:""),onSuccess:e=>{S.back()}}),{mutate:M}=(0,o.D)({mutationFn:e=>{var r;return(0,v.Xo)(e,null!=n?n:"",null!==(r=C.get("record_id"))&&void 0!==r?r:"")},onSuccess:e=>{S.back()}});return(0,a.jsxs)("section",{className:"".concat(k().diary_record," container"),children:[(0,a.jsxs)("div",{className:k().diary_record__fixed_menu,children:[(0,a.jsxs)("div",{className:k().diary_record__top,children:[(0,a.jsxs)("div",{className:k().diary_record__header,children:[(0,a.jsx)(j.r,{name:"back",onClick:()=>{S.back()},children:(0,a.jsx)(f.CC,{})}),(0,a.jsx)(x.r0,{size:"small",onClick:()=>{let e=N("title"),r=JSON.stringify(null==D?void 0:D.getHTML());C.get("record_id")?M({note:r,title:e||y()(null==w?void 0:w.created_at).format("dddd")}):E({note:r,title:e||y()(null==w?void 0:w.created_at).format("dddd")})},children:"Зберегти"})]}),(0,a.jsx)("div",{children:y()(null==w?void 0:w.created_at).format("DD.MM.YYYY")})]}),(0,a.jsx)(b.e,{editor:D})]}),"pending"!==B||w?(0,a.jsxs)("div",{className:k().diary_record__editor_box,children:[(0,a.jsx)(m.Qr,{control:u,name:"title",defaultValue:null!==(r=null==w?void 0:w.title)&&void 0!==r?r:"",render:e=>{let{field:{value:r,onChange:n}}=e;return(0,a.jsx)("input",{value:r,onChange:n,className:k().diary_record__title_input,placeholder:"Що сталося сьогодні? "})},rules:{required:g.C1,pattern:g.ES}},"title"),(0,a.jsx)(_.kg,{editor:D})]}):(0,a.jsx)("div",{children:"Завантаження"})]})};r.default=C},6633:function(e,r,n){"use strict";n.d(r,{e:function(){return c}});var a=n(7437);n(2265);var t=n(130),o=n(3040),d=n.n(o);let i=[{color:"#BD3333"},{color:"#647DAD"},{color:"#B0C597"},{color:"#FFC75A"}];var c=e=>{let{editor:r}=e;return r?(0,a.jsxs)("div",{className:d().menu_bar,children:[(0,a.jsxs)("div",{className:d().menu_bar__top,children:[(0,a.jsx)("button",{onClick:()=>null==r?void 0:r.chain().focus().undo().run(),disabled:!(null==r?void 0:r.can().chain().focus().undo().run()),children:(0,a.jsx)(t.cO,{})}),(0,a.jsx)("button",{className:d().menu_bar__redo_btn,onClick:()=>r.chain().focus().redo().run(),disabled:!r.can().chain().focus().redo().run(),children:(0,a.jsx)(t.cO,{})}),(0,a.jsx)("button",{onClick:()=>r.chain().focus().toggleBold().run(),disabled:!r.can().chain().focus().toggleBold().run(),className:"".concat(r.isActive("bold")?"is-active":""," ").concat(d().menu_bar__bold_text),children:(0,a.jsx)(t.pF,{})}),(0,a.jsx)("button",{onClick:()=>r.chain().focus().toggleBulletList().run(),className:"".concat(r.isActive("bulletList")?"is-active":"","  ").concat(d().menu_bar__list),children:(0,a.jsx)(t.Zd,{})}),(0,a.jsx)("button",{onClick:()=>r.chain().focus().deleteSelection().run(),className:r.isActive("clearContent")?"is-active":"",children:(0,a.jsx)(t.kJ,{})})]}),(0,a.jsx)("div",{className:d().menu_bar__colors,children:i.map(e=>(0,a.jsx)("button",{style:{backgroundColor:e.color},onClick:()=>null==r?void 0:r.chain().focus().setColor(e.color).run(),className:"".concat((null==r?void 0:r.isActive("textStyle",{color:e.color}))?"is-active":""," ").concat(d().menu_bar__color_btn)},e.color))})]}):null}},5029:function(e){e.exports={diary:"diary_diary__vakwU",diary__disable_new_record:"diary_diary__disable_new_record__1uGJw",diary__records:"diary_diary__records__Raa_y",diary__record_block:"diary_diary__record_block__lSxZE",diary__record_cards:"diary_diary__record_cards__fDCoQ",diary__hidden_cards:"diary_diary__hidden_cards__Wzxup",extended:"diary_extended__eP6mO",diary__hidden_wrapper:"diary_diary__hidden_wrapper__sNgIn",diary__arrow_btn:"diary_diary__arrow_btn__yRNYt"}},8789:function(e){e.exports={diary_card:"diary-note-card_diary_card__eMP4R",diary_card__header:"diary-note-card_diary_card__header__oWCce",diary_card__main:"diary-note-card_diary_card__main__4muem",diary_card__title:"diary-note-card_diary_card__title__o180J",diary_card__text:"diary-note-card_diary_card__text__5giJ3"}},7853:function(e){e.exports={diary:"diary-pin-code_diary__MFCQe"}},9091:function(e){e.exports={diary_record:"diary-record_diary_record__N_jDu",diary_record__fixed_menu:"diary-record_diary_record__fixed_menu__84zUz",diary_record__top:"diary-record_diary_record__top__vB_sS",diary_record__header:"diary-record_diary_record__header__04V_L",diary_record__editor_box:"diary-record_diary_record__editor_box__ayyIv",diary_record__title_input:"diary-record_diary_record__title_input__qzKkR"}},8186:function(e){e.exports={notes:"notes_notes__XQynD",notes__record_block:"notes_notes__record_block__4T5kK",notes__cards:"notes_notes__cards__phOl_",notes__hidden_cards:"notes_notes__hidden_cards__wyrdN",extended:"notes_extended__lsu5j",notes__hidden_wrapper:"notes_notes__hidden_wrapper__Y_jv7",notes__arrow_btn:"notes_notes__arrow_btn__nUzcR"}},3040:function(e){e.exports={menu_bar:"menu-bar_menu_bar__WPfCR",menu_bar__top:"menu-bar_menu_bar__top__t1aK0",menu_bar__colors:"menu-bar_menu_bar__colors__WeWGJ",menu_bar__redo_btn:"menu-bar_menu_bar__redo_btn__DwoNb",menu_bar__bold_text:"menu-bar_menu_bar__bold_text__2w3h3",menu_bar__list:"menu-bar_menu_bar__list__t6YNu",menu_bar__color_btn:"menu-bar_menu_bar__color_btn__s5AxH"}}},function(e){e.O(0,[6990,3572,7902,4382,2537,9831,130,7883,2971,8069,1744],function(){return e(e.s=4190)}),_N_E=e.O()}]);