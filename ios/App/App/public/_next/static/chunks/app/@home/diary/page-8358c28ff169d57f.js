(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4787],{1970:function(e,r,a){Promise.resolve().then(a.bind(a,1418))},2968:function(e,r,a){"use strict";a.d(r,{B3:function(){return y},OW:function(){return s},Vc:function(){return l},Xo:function(){return _},_K:function(){return b},os:function(){return c},s6:function(){return h}});var n=a(4642),o=a(568),d=a(2265),t=a(5520),i=a(9619);let c=(e,r)=>(0,t.Q)("users/diary/main/",{method:"POST",body:e,headers:{Authorization:"Bearer ".concat(r)}}),_=(e,r,a)=>(0,t.Q)("users/diary/main/".concat(a,"/"),{method:"PUT",body:e,headers:{Authorization:"Bearer ".concat(r)}}),s=(e,r)=>(0,t.Q)("users/diary/main/".concat(e,"/"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r)}}),l=e=>(0,n.a)({queryKey:["getDiaryRecords"],queryFn:()=>u(e)}),u=async e=>(0,t.Q)("users/diary/main/",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}),y=(e,r)=>(0,n.a)({queryKey:["getSingleDiaryRecord"],queryFn:()=>m(e,r),enabled:!1}),m=async(e,r)=>(0,t.Q)("users/diary/main/".concat(r),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}),h=(e,r,a)=>(0,n.a)({queryKey:["getRecordsByDate"],queryFn:()=>v(e,r,a),enabled:!1}),v=async(e,r,a)=>(0,t.Q)("users/diary/main/by-date/".concat(r,"/").concat(a),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}),x=async(e,r)=>(console.log(r),(0,t.Q)("users/diary/check-password/",{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:r})),b=()=>{let{user:e,handleChangeUserStore:r}=(0,i.LM)(),a=(0,i.LM)(e=>{var r;return null==e?void 0:null===(r=e.user)||void 0===r?void 0:r.has_dairy_password}),[n,t]=(0,d.useState)(!1),c=(null==e?void 0:e.access_token)||"",{mutate:_,status:s}=(0,o.D)({mutationFn:e=>x(c,e),onSuccess:e=>{t(e)},onError:e=>{console.log("Error: ".concat(e.message))}});return{mutateCheckPinCode:_,status:s,passShow:a&&!n,isPinVerified:n,setIsPinVerified:t}}},1418:function(e,r,a){"use strict";a.r(r),a.d(r,{DiaryComponent:function(){return C},default:function(){return S}});var n=a(7437),o=a(7907),d=a(568),t=a(2151),i=a.n(t),c=a(2968),_=a(7386),s=a(130),l=a(9619),u=a(8789),y=a.n(u),m=e=>{let{item:r,diaryRecordsRefetch:a}=e,t=(0,o.useRouter)(),u=(0,l.LM)(e=>{var r;return null===(r=e.user)||void 0===r?void 0:r.access_token}),{mutate:m}=(0,d.D)({mutationFn:e=>(0,c.OW)(e,null!=u?u:""),onSuccess:e=>{console.log(e,"data"),a()}});return(0,n.jsxs)("article",{className:y().diary_card,onClick:()=>{t.push("/diary/record?record_id=".concat(r.id.toString()))},children:[(0,n.jsxs)("div",{className:y().diary_card__header,children:[(0,n.jsx)("span",{children:i()(null==r?void 0:r.created_at).format("DD.MM.YYYY")}),(0,n.jsx)(_.r,{onClick:()=>{m(r.id.toString())},name:"delete record",children:(0,n.jsx)(s.kJ,{})})]}),(0,n.jsxs)("div",{className:y().diary_card__main,children:[(0,n.jsx)("p",{className:y().diary_card__title,children:null==r?void 0:r.title}),(0,n.jsx)("p",{className:y().diary_card__text,children:null==r?void 0:r.note})]})]})},h=a(2670),v=a(6583),x=a(3190),b=a(7853),f=a.n(b),j=e=>{let{onVerify:r}=e,{handleSubmit:a,control:o,formState:{isValid:d}}=(0,h.cI)({mode:"onTouched",reValidateMode:"onChange"});return(0,n.jsxs)("section",{className:"".concat(f().diary," container"),children:[(0,n.jsx)(v.qA,{title:"Введи пароль"}),(0,n.jsx)(v.cD,{onSubmit:a(e=>{r(e)}),textButton:"Далі",isFormValid:d,children:(0,n.jsx)(h.Qr,{control:o,name:"dairy_password",render:e=>{let{field:{value:r,onChange:a}}=e;return(0,n.jsx)(v.kq,{length:4,value:r,onChange:e=>a(e)})},rules:{required:x.C1,minLength:{value:4,message:""}}})})]})};a(383);var p=a(2265),g=a(4796),N=a(5029),k=a.n(N);let C=()=>{var e,r,a,d,t;let u=(0,o.useRouter)(),y=(0,l.LM)(e=>{var r;return null===(r=e.user)||void 0===r?void 0:r.access_token}),[h,x]=(0,p.useState)("main"),[b,f]=(0,p.useState)({year:null,month:null}),{data:N,refetch:C}=(0,c.Vc)(null!=y?y:""),{data:S,refetch:D,isFetching:w}=(0,c.s6)(null!=y?y:"",null!==(d=null===(e=b.year)||void 0===e?void 0:e.toString())&&void 0!==d?d:"",null!==(t=null===(r=b.month)||void 0===r?void 0:r.toString())&&void 0!==t?t:""),A=(e,r)=>{b.year===e&&b.month===r?f({year:null,month:null}):(console.log("else"),f({year:e,month:r}),setTimeout(()=>D(),0))},M=()=>{C()},{mutateCheckPinCode:B,passShow:R}=(0,c._K)();return R?(0,n.jsx)(j,{onVerify:e=>{B(e)}}):(console.log(null==N?void 0:N.has_note_today,"diaryRecords && diaryRecords?.has_note_today"),(0,n.jsxs)("section",{className:"".concat(k().diary," container"),children:[(0,n.jsx)("h1",{className:"title",children:"Щоденник"}),(0,n.jsx)(v.N3,{buttons:[{id:"main",text:"Основні",isActive:"main"===h},{id:"notes",text:"Нотатки",isActive:"notes"===h}],onButtonClick:x}),(null==N?void 0:N.has_note_today)?(0,n.jsx)("p",{className:k().diary__disable_new_record,children:"Запис про сьогоднішній день вже створено. Так тримати!"}):(0,n.jsx)(v.r0,{variant:"outlined",onClick:()=>{u.push("/diary/record")},children:"Додати запис"}),(0,n.jsx)("div",{className:k().diary__records,children:null==N?void 0:null===(a=N.notes)||void 0===a?void 0:a.map((e,r)=>{var a;return(0,n.jsx)("div",{className:k().diary__records,children:null==e?void 0:null===(a=e.months)||void 0===a?void 0:a.map((r,a)=>(0,n.jsxs)("div",{className:k().diary__record_block,children:[(0,n.jsxs)("p",{children:[i()().month(r.month).format("MMMM")," ",e.year]}),(0,n.jsxs)("div",{className:k().diary__record_cards,children:[(0,n.jsx)("div",{className:k().diary__visible_cards,children:r.notes.slice(0,1).map(e=>(0,n.jsx)(m,{item:e,diaryRecordsRefetch:M},"".concat(e.id,"-").concat(a)))}),!w&&(null==S?void 0:S.notes)&&(0,n.jsx)("div",{className:"".concat(k().diary__hidden_cards," ").concat(b.month===r.month&&b.year===e.year&&k().extended),children:(0,n.jsx)("div",{className:k().diary__hidden_wrapper,children:null==S?void 0:S.notes.slice(1).map((e,r)=>(0,n.jsx)(m,{item:e,diaryRecordsRefetch:M},"".concat(e.id,"-").concat(r)))})}),r.notes.length>1&&(0,n.jsx)("div",{className:"".concat(k().diary__arrow_btn," ").concat(b.month===r.month&&b.year===e.year&&k().extended),children:(0,n.jsx)(_.r,{onClick:()=>A(e.year,r.month),name:"open all",children:(0,n.jsx)(s.Ej,{})})})]})]},"".concat(r.month,"-").concat(a)))},"".concat(e.year,"-").concat(r))})}),(0,n.jsx)(v.Hu,{title:"Щоденник - це надійне місце для усіх твоїх спогадів та емоцій. Роби записи кожного дня щоб отримувати",coin:!0,image:g.Nf,buttonText:"Круто!",check:"diary"})]}))};var S=C},383:function(e,r,a){"use strict";a.r(r),a.d(r,{DiaryRecordComponent:function(){return w},default:function(){return A}});var n=a(7437),o=a(7907),d=a(568),t=a(7473),i=a(9540),c=a(2759),_=a(2357),s=a(2045),l=a(4586),u=a(2151),y=a.n(u),m=a(2265),h=a(2670),v=a(2968),x=a(6583),b=a(130),f=a(3040),j=a.n(f);let p=[{color:"#BD3333"},{color:"#647DAD"},{color:"#B0C597"},{color:"#FFC75A"}];var g=e=>{let{editor:r}=e;return r?(0,n.jsxs)("div",{className:j().menu_bar,children:[(0,n.jsxs)("div",{className:j().menu_bar__top,children:[(0,n.jsx)("button",{onClick:()=>null==r?void 0:r.chain().focus().undo().run(),disabled:!(null==r?void 0:r.can().chain().focus().undo().run()),children:(0,n.jsx)(b.cO,{})}),(0,n.jsx)("button",{className:j().menu_bar__redo_btn,onClick:()=>r.chain().focus().redo().run(),disabled:!r.can().chain().focus().redo().run(),children:(0,n.jsx)(b.cO,{})}),(0,n.jsx)("button",{onClick:()=>r.chain().focus().toggleBold().run(),disabled:!r.can().chain().focus().toggleBold().run(),className:"".concat(r.isActive("bold")?"is-active":""," ").concat(j().menu_bar__bold_text),children:(0,n.jsx)(b.pF,{})}),(0,n.jsx)("button",{onClick:()=>r.chain().focus().toggleBulletList().run(),className:"".concat(r.isActive("bulletList")?"is-active":"","  ").concat(j().menu_bar__list),children:(0,n.jsx)(b.Zd,{})}),(0,n.jsx)("button",{onClick:()=>r.chain().focus().deleteSelection().run(),className:r.isActive("clearContent")?"is-active":"",children:(0,n.jsx)(b.kJ,{})})]}),(0,n.jsx)("div",{className:j().menu_bar__colors,children:p.map(e=>(0,n.jsx)("button",{style:{backgroundColor:e.color},onClick:()=>null==r?void 0:r.chain().focus().setColor(e.color).run(),className:"".concat((null==r?void 0:r.isActive("textStyle",{color:e.color}))?"is-active":""," ").concat(j().menu_bar__color_btn)},e.color))})]}):null},N=a(7386),k=a(9619),C=a(3190),S=a(9091),D=a.n(S);let w=()=>{var e,r;let a=(0,k.LM)(e=>{var r;return null===(r=e.user)||void 0===r?void 0:r.access_token}),{control:u,watch:f}=(0,h.cI)(),j=(0,o.useSearchParams)(),p=(0,o.useRouter)(),{data:S,refetch:w,status:A}=(0,v.B3)(null!=a?a:"",null!==(e=j.get("record_id"))&&void 0!==e?e:""),M=(0,s.jE)({content:"",extensions:[c.V.configure({placeholder:"Як ти?"}),t.I.configure({types:[_.Z.name,i.Z.name]}),_.Z.configure(),l.Z.configure({bulletList:{keepMarks:!0,keepAttributes:!1},orderedList:{keepMarks:!0,keepAttributes:!1}})],editable:!0});(0,m.useEffect)(()=>{w()},[j.get("record_id")]),(0,m.useEffect)(()=>{var e;null==M||M.commands.setContent(null!==(e=null==S?void 0:S.note)&&void 0!==e?e:"")},[S,M]);let{mutate:B}=(0,d.D)({mutationFn:e=>(0,v.os)(e,null!=a?a:""),onSuccess:e=>{console.log(e,"data")}}),{mutate:R}=(0,d.D)({mutationFn:e=>{var r;return(0,v.Xo)(e,null!=a?a:"",null!==(r=j.get("record_id"))&&void 0!==r?r:"")},onSuccess:e=>{console.log(e,"data")}});return(0,n.jsxs)("section",{className:"".concat(D().diary_record," container"),children:[(0,n.jsxs)("div",{className:D().diary_record__fixed_menu,children:[(0,n.jsxs)("div",{className:D().diary_record__top,children:[(0,n.jsxs)("div",{className:D().diary_record__header,children:[(0,n.jsx)(N.r,{name:"back",onClick:()=>{p.back()},children:(0,n.jsx)(b.CC,{})}),(0,n.jsx)(x.r0,{size:"small",onClick:()=>{let e=f("title"),r=JSON.stringify(null==M?void 0:M.getHTML());j.get("record_id")?R({note:r,title:e||y()(null==S?void 0:S.created_at).format("dddd")}):B({note:r,title:e||y()(null==S?void 0:S.created_at).format("dddd")})},children:"Зберегти"})]}),(0,n.jsx)("div",{children:y()(null==S?void 0:S.created_at).format("DD.MM.YYYY")})]}),(0,n.jsx)(g,{editor:M})]}),"pending"!==A||S?(0,n.jsxs)("div",{className:D().diary_record__editor_box,children:[(0,n.jsx)(h.Qr,{control:u,name:"title",defaultValue:null!==(r=null==S?void 0:S.title)&&void 0!==r?r:"",render:e=>{let{field:{value:r,onChange:a}}=e;return(0,n.jsx)("input",{value:r,onChange:a,className:D().diary_record__title_input,placeholder:"Що сталося сьогодні? "})},rules:{required:C.C1,pattern:C.ES}},"title"),(0,n.jsx)(s.kg,{editor:M})]}):(0,n.jsx)("div",{children:"loading"})]})};var A=w},5029:function(e){e.exports={diary:"diary_diary__vakwU",diary__disable_new_record:"diary_diary__disable_new_record__1uGJw",diary__records:"diary_diary__records__Raa_y",diary__record_block:"diary_diary__record_block__lSxZE",diary__record_cards:"diary_diary__record_cards__fDCoQ",diary__hidden_cards:"diary_diary__hidden_cards__Wzxup",extended:"diary_extended__eP6mO",diary__hidden_wrapper:"diary_diary__hidden_wrapper__sNgIn",diary__arrow_btn:"diary_diary__arrow_btn__yRNYt"}},8789:function(e){e.exports={diary_card:"diary-note-card_diary_card__eMP4R",diary_card__header:"diary-note-card_diary_card__header__oWCce",diary_card__main:"diary-note-card_diary_card__main__4muem",diary_card__title:"diary-note-card_diary_card__title__o180J",diary_card__text:"diary-note-card_diary_card__text__5giJ3"}},7853:function(e){e.exports={diary:"diary-pin-code_diary__MFCQe"}},9091:function(e){e.exports={diary_record:"diary-record_diary_record__N_jDu",diary_record__fixed_menu:"diary-record_diary_record__fixed_menu__84zUz",diary_record__top:"diary-record_diary_record__top__vB_sS",diary_record__header:"diary-record_diary_record__header__04V_L",diary_record__editor_box:"diary-record_diary_record__editor_box__ayyIv",diary_record__title_input:"diary-record_diary_record__title_input__qzKkR"}},3040:function(e){e.exports={menu_bar:"menu-bar_menu_bar__WPfCR",menu_bar__top:"menu-bar_menu_bar__top__t1aK0",menu_bar__colors:"menu-bar_menu_bar__colors__WeWGJ",menu_bar__redo_btn:"menu-bar_menu_bar__redo_btn__DwoNb",menu_bar__bold_text:"menu-bar_menu_bar__bold_text__2w3h3",menu_bar__list:"menu-bar_menu_bar__list__t6YNu",menu_bar__color_btn:"menu-bar_menu_bar__color_btn__s5AxH"}}},function(e){e.O(0,[6990,3572,7902,109,2537,9831,130,7883,2971,8069,1744],function(){return e(e.s=1970)}),_N_E=e.O()}]);